spin_manifest_version = 2

[application]
name = "myT2ABRP"
version = "0.1.0"
description = "Toyota MyT to A Better Routeplanner"
authors = ["Ralf Anton Beier <ralf_beier@me.com>"]

[application.trigger.http]
base = "/"

[variables]
# Credentials can be provided via Basic Auth or environment variables
password = { required = false, secret = true }
username = { required = false }
# VIN is still required unless using /vehicles endpoint only
vin = { required = false }
# HMAC key for secure username hashing (CRITICAL: set to random value in production)
hmac_key = { required = false, secret = true }

[[trigger.http]]
route = "/..."
component = "myt2abrp"

[component.myt2abrp]
source = "target/wasm32-wasip1/release/myt2abrp.wasm"
allowed_outbound_hosts = [
    "https://b2c-login.toyota-europe.com",
    "https://ctpa-oneapi.tceu-ctp-prd.toyotaconnectedeurope.io"
]
key_value_stores = ["default"]
[component.myt2abrp.build]
command = "cargo build --target wasm32-wasip1 --release"
watch = ["myt2abrp/src/**/*.rs", "myt2abrp/Cargo.toml", "Cargo.toml", "myt/src/**/*.rs", "myt/Cargo.toml"]
[component.myt2abrp.variables]
password = "{{ password }}"
username = "{{ username }}"
vin = "{{ vin }}"
hmac_key = "{{ hmac_key }}"